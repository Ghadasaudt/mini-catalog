<h2>{{ isEdit ? 'Edit item' : 'New item' }}</h2>

<form [formGroup]="form" (ngSubmit)="submit()" novalidate>
  <label>
    Title
    <input type="text" formControlName="title" aria-describedby="titleError" />
  </label>
  <div id="titleError" *ngIf="form.get('title')?.invalid && form.get('title')?.touched">
    <small *ngIf="form.get('title')?.errors?.['required']">Title required.</small>
    <small *ngIf="form.get('title')?.errors?.['minlength']">Min 3 chars.</small>
    <small *ngIf="form.get('title')?.errors?.['maxlength']">Max 80 chars.</small>
  </div>

  <label>
    Category
    <input type="text" formControlName="category" />
  </label>
  <div *ngIf="form.get('category')?.invalid && form.get('category')?.touched">
    <small>Category required.</small>
  </div>

  <label>
    Price
    <input type="number" step="0.01" formControlName="price" />
  </label>
  <div *ngIf="form.get('price')?.invalid && form.get('price')?.touched">
    <small *ngIf="form.get('price')?.errors?.['required']">Price required.</small>
    <small *ngIf="form.get('price')?.errors?.['min']">Must be > 0.</small>
  </div>

  <label>
    Rating
    <input type="number" step="0.5" formControlName="rating" min="0" max="5" />
  </label>

  <label>
    Description
    <textarea formControlName="description" rows="4"></textarea>
  </label>
  <div *ngIf="form.get('description')?.invalid && form.get('description')?.touched">
    <small *ngIf="form.get('description')?.errors?.['maxlength']">Max 500 chars.</small>
  </div>

  <label>
    Image URL (optional)
    <input type="url" formControlName="imageUrl" />
  </label>
  <div *ngIf="form.get('imageUrl')?.invalid && form.get('imageUrl')?.touched">
    <small>Must be a valid image URL (png/jpg/...)</small>
  </div>

  <button type="submit" [disabled]="form.invalid">{{ isEdit ? 'Update' : 'Create' }}</button>
  <a routerLink="/">Cancel</a>
</form>
